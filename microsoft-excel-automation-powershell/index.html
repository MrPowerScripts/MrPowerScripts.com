<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>Microsoft Excel Automation with Powershell – MrPowerScripts – Learn. Code. Grow.</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>
    <link rel="canonical" href="https://mrpowerscripts.com/microsoft-excel-automation-powershell/">

    
    <meta name="description" content="Do you want to take your Excel skills to the next level? Did you know that you don't need Excel to work with Excel files? Sometimes doing things programmatically is a bit easier than pointing and clicking. Or maybe you need to process a lot of files really fast, over and over again. Powershell automation with Microsoft Excel is possible! In this video you'll see how you can update Excel workbooks and worksheets with a Powershell script." />
    <meta property="og:description" content="Do you want to take your Excel skills to the next level? Did you know that you don't need Excel to work with Excel files? Sometimes doing things programmatically is a bit easier than pointing and clicking. Or maybe you need to process a lot of files really fast, over and over again. Powershell automation with Microsoft Excel is possible! In this video you'll see how you can update Excel workbooks and worksheets with a Powershell script." />
    
    <meta name="author" content="MrPowerScripts" />

    
    <meta property="og:title" content="Microsoft Excel Automation with Powershell" />
    <meta property="twitter:title" content="Microsoft Excel Automation with Powershell" />
    

    
    <meta content="/images/mpslogo.png" property="og:image">
    

    
        
    <meta content="mrpowerscripts" property="article:tag">
        
    <meta content="Microsoft Excel Automation" property="article:tag">
        
    <meta content="Microsoft Excel Powershell Automation. Automation with Powershell" property="article:tag">
        
    <meta content="Powershell Excel workbooks and worksheets" property="article:tag">
        
    

    <link rel="apple-touch-icon" sizes="57x57" href="/images/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/images/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/images/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/images/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/images/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/images/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/images/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/images/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/images/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="manifest" href="/images/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/images/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="MrPowerScripts - Learn. Code. Grow." href="/feed.xml" />


    <meta name="google-site-verification" content="prYTc9sgHOxJOubz6hLVkkfpea2I82I0UfoePeJ_FEg" />
    <meta name="msvalidate.01" content="5518FAB6C86578E1F5002CD56C1B5F24" />
    <meta name="yandex-verification" content="4539896b000a5ed9" />
    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->

    
    
        <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Microsoft Excel Automation with Powershell",
        "description": "Do you want to take your Excel skills to the next level? Did you know that you don't need Excel to work with Excel files? Sometimes doing things programmatically is a bit easier than pointing and clicking. Or maybe you need to process a lot of files really fast, over and over again. Powershell automation with Microsoft Excel is possible! In this video you'll see how you can update Excel workbooks and worksheets with a Powershell script.",
        "image": [
            
                "https://mrpowerscripts.com/images/twilightyellow.png"
            
        ],
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://mrpowerscripts.com/microsoft-excel-automation-powershell/"
        },
        "datePublished": "2019-03-24 11:00:45 +0000",
        "dateModified": "2019-03-24 11:00:45 +0000",
        "isAccessibleForFree": "True",
        "isPartOf": {
            "@type": ["CreativeWork", "Product", "Blog"],
            "name": "MrPowerScripts",
            "productID": ""
        },
        "license": "http://creativecommons.org/licenses/by-sa/4.0/",
        "author": {
            "@type": "Person",
            "name": "MrPowerScripts",
            "description": "MrPowerScripts is here to help you automate your life so you have more time for automating your life. 
My youtube channel started as a way for me to share stuff I was learning about Powershell. That was in 2012, and 
since then the channel and grown in many different ways as my career and skills have envolved. My new goal with the channel
is to try and automate it entirely. I'll be sharing a lot about that journey of automation while continuing 
other porjects and sharing them here on my blog as well as youtube. Join my on Discord if you have any questions.
",
            "sameAs": "https://mrpowerscripts.com/about",
            "image": {
                "@type": "ImageObject",
                "url": "https://mrpowerscripts.com/images/twilightyellow.png"
            },
            "givenName": "",
            "familyName": "",
            "alternateName": "MrPowerScripts",
            "publishingPrinciples": "https://mrpowerscripts.com/about/"
        },
        "publisher": {
            "@type": "Organization",
            "name": "MrPowerScripts",
            "description": "MrPowerScripts is here to help you automate your life so you have more time for automating your life. 
My youtube channel started as a way for me to share stuff I was learning about Powershell. That was in 2012, and 
since then the channel and grown in many different ways as my career and skills have envolved. My new goal with the channel
is to try and automate it entirely. I'll be sharing a lot about that journey of automation while continuing 
other porjects and sharing them here on my blog as well as youtube. Join my on Discord if you have any questions.
",
            "sameAs": "https://mrpowerscripts.com",
            "logo": {
                "@type": "ImageObject",
                "url": "https://mrpowerscripts.com/images/twilightyellow.png"
            },
            "publishingPrinciples": "https://mrpowerscripts.com/about/"
        }
    }
</script>
    
      
  </head>

  <body>
    <div class="wrapper-masthead">
      <div id='stars'></div>
      <div id='stars2'></div>
      <div id='stars3'></div>
      <div class="container">
        <header class="masthead">
          <div class="mh-txt-wrap">
            <a href="/" class="site-avatar"><img src="https://mrpowerscripts.com/images/twilightyellow.png" alt="site avatar" /></a>
            <div class="site-info">
              <h2 class="site-name"><a href="/">MrPowerScripts</a></h2>
              <p class="site-description">Learn. Code. Grow.</p>
            </div>
          </div>

          <nav>
            <a href="/categories">Categories</a>
            <!-- <a onclick="selectRandom()">Random</a> -->
            <!-- <a href="/podcast">Podcast</a> -->
            <a href="http://bit.ly/mrps-discord">Discord</a>
            <!-- <a href="/about">About</a> -->
            <a href="/power-up" class="power-up">Power Up</a>
            <a href="/product_reviews">Reviews</a>
          </nav>

        </header>
        <!-- <div class="meta-links">
            
<a href="mailto:playingwithpowershell@gmail.com">e-mail</a> |


<a href="https://github.com/mrpowerscripts">github</a> |



<a href="/feed.xml">rss</a> |
<a href="https://www.twitter.com/mrpowerscripts">twitter</a> |

<a href="https://youtube.com/user/mrpowerscripts">youtube</a> |

<a href="https://discord.gg/uEBWZKq">discord</a> |
<a href="https://patreon.com/mrpowerscripts">patreon</a>

<style>
.meta-links {
    display: flex;
    color: white;
    justify-content: space-around;
}

.meta-links a {
  color: white;
  padding: 0px 0px;
}

.meta-links a:hover {
  color:purple;
}
</style>
        </div> -->
        <!-- 
<div id="share-bar">

  <h4>Share this:</h4>

  <div class="share-buttons">
      <a  href="https://www.facebook.com/sharer/sharer.php?u=https://mrpowerscripts.com/microsoft-excel-automation-powershell/"
          onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
          title="Share on Facebook" >
          <i class="fa fa-facebook-official share-button"> facebook</i>
      </a>

      <a  href="https://twitter.com/intent/tweet?text=Microsoft Excel Automation with Powershell&url=https://mrpowerscripts.com/microsoft-excel-automation-powershell/"
          onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
          title="Share on Twitter" >
          <i class="fa fa-twitter share-button"> twitter</i>
      </a>

      <a  href="http://www.tumblr.com/share/link?url=https://mrpowerscripts.com/microsoft-excel-automation-powershell/"
          onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"
          title="Share on Tumblr" >
          <i class="fa fa-tumblr share-button"> tumblr</i>
      </a>

      <a  href="http://www.reddit.com/submit?url=https://mrpowerscripts.com/microsoft-excel-automation-powershell/"
          onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"
          title="Share on Reddit" >
          <i class="fa fa-reddit-alien share-button"> reddit</i>
      </a>

      <a  href="https://www.linkedin.com/shareArticle?mini=true&url=https://mrpowerscripts.com/microsoft-excel-automation-powershell/&title=Microsoft Excel Automation with Powershell&summary=&source="
          onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
          title="Share on LinkedIn" >
          <i class="fa fa-linkedin share-button"> linkedin</i>
      </a>

      <a  href="mailto:?subject=Microsoft Excel Automation with Powershell&amp;body=Check out this site https://mrpowerscripts.com/microsoft-excel-automation-powershell/"
          title="Share via Email" >
          <i class="fa fa-envelope share-button"> email</i>
      </a>
  </div>

</div> let's hide this until it looks pretty-->
      </div>
    </div>

    <div id="main" role="main" class="container">
      <!-- <div id="active-motions" class="active-motions">
  <h3>Active Discord Votes</h3>
  <div class="active-motion-list" id="active-motion-list"></div>
</div>

<script>
function isMRPS(messageID) {
  if (parseInt(messageID) === 510819339411390474) {
    // console.log('motion is mine')
    return true
  } else {
    // console.log('motion is not mine')
    return false
  }
}

window.addEventListener('load', function() {
  fetch("http://dr.mrpowerscripts.com:8888/motionsData.json")
  .then(res => res.json())
  .then(out => {
    window.motions = out.motions
    var motions = out.motions.filter(i => isMRPS(i.author)).slice(0, 3)
    // console.log(motions)
    
    var activeMotionList = document.getElementById("active-motion-list")

    for (var i = 0; i < motions.length; i++) {
      var motion = document.createElement('a')

      motion.href = `https://discordapp.com/channels/510821302773219331/534510417448402965/${motions[i].msg}`
      motion.target = '_blank'
      motion.innerHTML = `⚈ ${motions[i].text}`
      activeMotionList.appendChild(motion);
    }

    if (motions.length) {
      document.getElementById("active-motions").style.height = "100%"
      document.getElementById("active-motions").style.opacity = "1"
    }
  })
}, false);
</script> -->
<article class="post">
  <div class="reviews">
  <div id="suggested-reviews" class="suggested-reviews">
    <h4>Suggested reviews for you</h4>
    <ul class="suggested-reviews-list">
      <li><a href="" class="suggested-reviews-1" id="suggested-reviews-1"></a></li>
      <li><a href="" class="suggested-reviews-2" id="suggested-reviews-2"></a></li>
      <li><a href="" class="suggested-reviews-3" id="suggested-reviews-3"></a></li>
      <li><a href="" class="suggested-reviews-4" id="suggested-reviews-4"></a></li>
      <li><a href="" class="suggested-reviews-5" id="suggested-reviews-5"></a></li>
    </ul>
  </div>
</div>

<script>
    window.addEventListener('load', function() {
      fetch(window.location.origin+"/api-reviews.json")
      .then(res => res.json())
      .then(out => {
        var posts = out.sort(() => .5 - Math.random()).slice(0,5)
        let i
        for (i=0; i < posts.length; i++) {
          document.getElementById(`suggested-reviews-${i + 1}`).text = posts[i].title
          document.getElementById(`suggested-reviews-${i + 1}`).href = posts[i].url
        }
    
        let content = document.getElementById('suggested-reviews')
        if (content.style.maxHeight){
          content.style.maxHeight = null;
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
        } 

      })
      .catch(error => console.error(error))
    }, false);
    </script>
  
<h2><a href="">Microsoft Excel Automation with Powershell</a></h2>
<div class="post-menu-bar">
  <span>MrPowerScripts</span> |
  <span>March 24, 2019</span> |
  <span class="reading-time" title="Estimated read time">
  
  
  4 mins
  
</span>

<!-- 
Genius https://carlosbecker.com/posts/jekyll-reading-time-without-plugins/ 
Double genius https://scottdorman.github.io/2017/07/09/adding-reading-time-to-blog-posts/
-->

  <a class="edit-button" href="https://github.com/MrPowerScripts/MrPowerScripts.com/tree/master/">Edit</a>
</div>

  <div class="entry">
    <p>Do you want to take your Excel skills to the next level? Did you know that you don’t need Excel to work with Excel files? Sometimes doing things programmatically is a bit easier than pointing and clicking. Or maybe you need to process a lot of files really fast, over and over again. Powershell automation with Microsoft Excel is possible! <!-- (1) video wrapper --></p>
<div class="youtube-video" data-embed="3blgg3QfJP8"> 
 
    <!-- (2) the "play" button -->
    <div class="play-button"></div> 
     
</div>
<p>In this video you’ll see how you can update Excel workbooks and worksheets with a Powershell script.</p>

<p>Excel has a COM interface which is a technology developed by Microsoft  (of course). I’ve never read an amazing explanation of COM but basically, it allows communication between programming languages and Windows applications. Even if the application was not built with the programming language. Powershell is more of a scripting language, but we can connect to the Excel COM interface all the same.</p>

<p>Through this COM interface Excel exposes <a href="https://docs.microsoft.com/en-us/office/vba/api/overview/excel/object-model">the Excel Object Model</a>. I’ve linked you to the current docs, but that link will probably be dead in six months - because Microsoft. Also, the examples shown  for the Excel Object Model use something called Visual Basic for Applications. Which is something I learned about 5 minutes ago when I was trying to find the old generic Excel Object Model reference. Apparently it doesn’t exist anymore. Once again, because Microsoft. I wish I could offer more help and insights but - Microsoft. Still, you can use the script below to play around with creating and updating workbooks and worksheets. You can also explore the properties of the excel object with <code class="highlighter-rouge">Get-Member</code> to learn more about the available options.</p>

<p>You can <a href="https://github.com/MrPowerScripts/PowerScripts/blob/16740162b415b9d91f9d4bbd930b2a6d33de1788/Excel/WorkbooksAndWorksheetsExcel.ps1">find the file here on GitHub</a> or check out the source below.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">
</span><span class="c">#None of this will work through an already open excel application</span><span class="w">
</span><span class="c">#You must open Excel and workbooks you want to manipulate via the COMobject</span><span class="w">

</span><span class="c">####################################################</span><span class="w">
</span><span class="c">############### Starting Excel #####################</span><span class="w">
</span><span class="c">####################################################</span><span class="w">

</span><span class="nv">$Excel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">New-Object</span><span class="w"> </span><span class="nt">-ComObject</span><span class="w"> </span><span class="nx">Excel.Application</span><span class="w">

</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Visible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$true</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">DisplayAlerts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$false</span><span class="w">

</span><span class="c">####################################################</span><span class="w">
</span><span class="c">############## Working with Workbooks ##############</span><span class="w">
</span><span class="c">####################################################</span><span class="w">

</span><span class="c">#Add a workbook to your current excel file</span><span class="w">
</span><span class="c">#You can add multiple workbooks with this method</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Workbooks</span><span class="o">.</span><span class="nf">Add</span><span class="p">()</span><span class="w">

</span><span class="c">#Find all the workbooks in your excel file by name</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Workbooks</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">Select-Object</span><span class="w"> </span><span class="nt">-ExpandProperty</span><span class="w"> </span><span class="nx">name</span><span class="w">

</span><span class="c">#Activate a specifc workbook in your excel file</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Workbooks</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="nx">2</span><span class="p">)</span><span class="o">.</span><span class="nf">activate</span><span class="p">()</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Workbooks</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="s2">"book1"</span><span class="p">)</span><span class="o">.</span><span class="nf">activate</span><span class="p">()</span><span class="w">

</span><span class="c">#Acivate Random Workbook in Excel file</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Workbooks</span><span class="o">.</span><span class="nf">Item</span><span class="p">((</span><span class="nf">Get-Random</span><span class="w"> </span><span class="nt">-min</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nt">-Max</span><span class="w"> </span><span class="p">(</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Workbooks</span><span class="o">.</span><span class="nf">Count</span><span class="o">+</span><span class="nx">1</span><span class="p">)))</span><span class="o">.</span><span class="nf">activate</span><span class="p">()</span><span class="w">

</span><span class="c">#Open an existing workbook on your hardrive</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Workbooks</span><span class="o">.</span><span class="nf">Open</span><span class="p">(</span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="s2">\desktop\mrpowerscripts.xlsx"</span><span class="p">)</span><span class="w">

</span><span class="c">#close workbooks from an excel file</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Workbooks</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="nx">1</span><span class="p">)</span><span class="o">.</span><span class="nf">close</span><span class="p">()</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Workbooks</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="s2">"MrPowerScripts.xlsx"</span><span class="p">)</span><span class="o">.</span><span class="nf">close</span><span class="p">()</span><span class="w">

</span><span class="c">#Save workbooks to the hard drive</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Workbooks</span><span class="o">.</span><span class="nf">item</span><span class="p">(</span><span class="nx">1</span><span class="p">)</span><span class="o">.</span><span class="nf">SaveAs</span><span class="p">(</span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="s2">\Desktop\asdf.xlsx"</span><span class="p">)</span><span class="w">


</span><span class="c">####################################################</span><span class="w">
</span><span class="c">########### Working with Worksheets ################</span><span class="w">
</span><span class="c">####################################################</span><span class="w">

</span><span class="c">#These bits of code will affect the active Workbook.</span><span class="w">

</span><span class="c">#Add a worksheet to your active workbook</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Worksheets</span><span class="o">.</span><span class="nf">Add</span><span class="p">()</span><span class="w">

</span><span class="c">#Find all worksheets in your active workbook</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Worksheets</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">Select-Object</span><span class="w"> </span><span class="nt">-ExpandProperty</span><span class="w"> </span><span class="nx">name</span><span class="w">

</span><span class="c">#Change name of worksheet in workbook</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Worksheets</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="nx">1</span><span class="p">)</span><span class="o">.</span><span class="nf">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"potato"</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Worksheets</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="s2">"potato"</span><span class="p">)</span><span class="o">.</span><span class="nf">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"spud"</span><span class="w">

</span><span class="c">#Activate specific worksheet in workbook</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Worksheets</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="nx">2</span><span class="p">)</span><span class="o">.</span><span class="nf">activate</span><span class="p">()</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Worksheets</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="s2">"sheet3"</span><span class="p">)</span><span class="o">.</span><span class="nf">activate</span><span class="p">()</span><span class="w">

</span><span class="c">#Acivate Random Worksheet in Excel file</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Worksheets</span><span class="o">.</span><span class="nf">Item</span><span class="p">((</span><span class="nf">Get-Random</span><span class="w"> </span><span class="nt">-min</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nt">-Max</span><span class="w"> </span><span class="p">(</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Worksheets</span><span class="o">.</span><span class="nf">Count</span><span class="o">+</span><span class="nx">1</span><span class="p">)))</span><span class="o">.</span><span class="nf">activate</span><span class="p">()</span><span class="w">

</span><span class="c">#Delete worksheets from workbook</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Worksheets</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="nx">1</span><span class="p">)</span><span class="o">.</span><span class="nf">delete</span><span class="p">()</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Worksheets</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="s2">"Sheet3"</span><span class="p">)</span><span class="o">.</span><span class="nf">delete</span><span class="p">()</span><span class="w">


</span><span class="c">####################################################</span><span class="w">
</span><span class="c">########## Cleaning up the environment #############</span><span class="w">
</span><span class="c">####################################################</span><span class="w">

</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Workbooks</span><span class="o">.</span><span class="nf">Close</span><span class="p">()</span><span class="w">
</span><span class="nv">$Excel</span><span class="o">.</span><span class="nf">Quit</span><span class="p">()</span><span class="w">

</span><span class="c">#Check and you will see an excel process still exists after quitting</span><span class="w">
</span><span class="c">#Remove the excel process by piping it to stop-process</span><span class="w">
</span><span class="nf">Get-Process</span><span class="w"> </span><span class="nx">excel</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">Stop-Process</span><span class="w"> </span><span class="nt">-Force</span><span class="w">

</span><span class="c">#Now we must release the $excel com object to ready it for garbage collection</span><span class="w">
</span><span class="p">[</span><span class="no">System.Runtime.Interopservices.</span><span class="kt">Marshal</span><span class="p">]::</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="nv">$Excel</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

  </div>

  <div class="date">
    Written on March 24, 2019
  </div>
  <hr>
  <div>
  Do you have some thoughts on this article? Come chat about it on <a href="http://bit.ly/mrps-discord">Discord</a>.
  If you enjoy the content <a href="/power-up">check out ways you can support the site</a>.
</div>
  <div id="suggested" class="suggested" hidden>
  <h4>Suggested posts for you</h4>
  <div class="suggested-posts">
    <a href="" class="suggested-post" id="suggested-1"></a>
    <a href="" class="suggested-post" id="suggested-2"></a>
    <a href="" class="suggested-post" id="suggested-3"></a>
    <a href="" class="suggested-post" id="suggested-4"></a>
    <a href="" class="suggested-post" id="suggested-5"></a>
  </div>
</div>

<script>
    window.addEventListener('load', function() {
      fetch(window.location.origin+"/api.json")
      .then(res => res.json())
      .then(out => {
        var posts = out.sort(() => .5 - Math.random()).slice(0,5)
        let i
        for (i=0; i < posts.length; i++) {
          document.getElementById(`suggested-${i + 1}`).text = posts[i].title
          document.getElementById(`suggested-${i + 1}`).href = posts[i].url
        }
    
        document.getElementById("suggested").hidden = false
      })
      .catch(error => console.error(error))
    }, false);
    </script>
</article>




    </div>

    <div class="wrapper-footer">
      <div class="container">
        <!-- 
<div id="share-bar">

  <h4>Share this:</h4>

  <div class="share-buttons">
      <a  href="https://www.facebook.com/sharer/sharer.php?u=https://mrpowerscripts.com/microsoft-excel-automation-powershell/"
          onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
          title="Share on Facebook" >
          <i class="fa fa-facebook-official share-button"> facebook</i>
      </a>

      <a  href="https://twitter.com/intent/tweet?text=Microsoft Excel Automation with Powershell&url=https://mrpowerscripts.com/microsoft-excel-automation-powershell/"
          onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
          title="Share on Twitter" >
          <i class="fa fa-twitter share-button"> twitter</i>
      </a>

      <a  href="http://www.tumblr.com/share/link?url=https://mrpowerscripts.com/microsoft-excel-automation-powershell/"
          onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"
          title="Share on Tumblr" >
          <i class="fa fa-tumblr share-button"> tumblr</i>
      </a>

      <a  href="http://www.reddit.com/submit?url=https://mrpowerscripts.com/microsoft-excel-automation-powershell/"
          onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"
          title="Share on Reddit" >
          <i class="fa fa-reddit-alien share-button"> reddit</i>
      </a>

      <a  href="https://www.linkedin.com/shareArticle?mini=true&url=https://mrpowerscripts.com/microsoft-excel-automation-powershell/&title=Microsoft Excel Automation with Powershell&summary=&source="
          onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
          title="Share on LinkedIn" >
          <i class="fa fa-linkedin share-button"> linkedin</i>
      </a>

      <a  href="mailto:?subject=Microsoft Excel Automation with Powershell&amp;body=Check out this site https://mrpowerscripts.com/microsoft-excel-automation-powershell/"
          title="Share via Email" >
          <i class="fa fa-envelope share-button"> email</i>
      </a>
  </div>

</div> -->
        <footer class="footer">
          
<a href="mailto:playingwithpowershell@gmail.com">e-mail</a> |


<a href="https://github.com/mrpowerscripts">github</a> |



<a href="/feed.xml">rss</a> |
<a href="https://www.twitter.com/mrpowerscripts">twitter</a> |

<a href="https://youtube.com/user/mrpowerscripts">youtube</a> |

<a href="https://discord.gg/uEBWZKq">discord</a> |
<a href="https://patreon.com/mrpowerscripts">patreon</a>

<style>
.meta-links {
    display: flex;
    color: white;
    justify-content: space-around;
}

.meta-links a {
  color: white;
  padding: 0px 0px;
}

.meta-links a:hover {
  color:purple;
}
</style>
        </footer>
      </div>
    </div>

    
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121890486-1"></script>
<script>
  if (document.location.hostname.search("mrpowerscripts.com") !== -1) {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-121890486-1');
}
</script>


<script type="text/javascript">var _kmq = _kmq || [];
  var _kmk = _kmk || 'a59a911fe1083dcbd2bc1717206ab09add1eea6a';
  function _kms(u){
    setTimeout(function(){
      var d = document, f = d.getElementsByTagName('script')[0],
      s = d.createElement('script');
      s.type = 'text/javascript'; s.async = true; s.src = u;
      f.parentNode.insertBefore(s, f);
    }, 1);
  }
  _kms('//i.kissmetrics.com/i.js');
  _kms('//scripts.kissmetrics.com/' + _kmk + '.2.js');
  </script>




    <script src="/scripts.js" ></script>
  </body>
</html>
